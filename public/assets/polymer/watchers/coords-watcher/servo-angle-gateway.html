<dom-module id="servo-angle-gateway">
  <script>
    class servoAngleGateway extends ReduxMixin(Polymer.Element) {
      static get is() { return 'servo-angle-gateway'; }
      
      emitAngles(angles) {
        // obj for storing filtered out servo angles
        var servoAngles = {};
        
        // loop through the payload obj and filter out servo angles
        for (let legId in angles) {
          // check if coxa servo angle is present
          if ('coxaServoAngle' in angles[legId]) {
            // check if the obj is created
            servoAngles[legId] = servoAngles[legId] || {};
            // assign a value
            servoAngles[legId].coxaServoAngle = angles[legId].coxaServoAngle;
          }
          // check if femur servo angle is present
          if ('femurServoAngle' in angles[legId]) {
            // check if the obj is created
            servoAngles[legId] = servoAngles[legId] || {};
            // assign a value
            servoAngles[legId].femurServoAngle = angles[legId].femurServoAngle;
          }
          // check if tibia servo angle is present
          if ('tibiaServoAngle' in angles[legId]) {
            // check if the obj is created
            servoAngles[legId] = servoAngles[legId] || {};
            // assign a value
            servoAngles[legId].tibiaServoAngle = angles[legId].tibiaServoAngle;
          }
        }
        
        // if there are some servo angles then send to the back end
        if (Object.keys(servoAngles).length !== 0)
          socket.emit('servo-angles-changed', servoAngles);
        
        // TODO temp. for debugging purposes
        if (angles[1] && angles[1].femurServoAngle)
          socket.emit('femur-servo-angle-changed', { value: angles[1].femurServoAngle });
      }

    }
    window.customElements.define(servoAngleGateway.is, servoAngleGateway);
  </script>
</dom-module>